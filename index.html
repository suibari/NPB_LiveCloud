<!doctype html>
<html lang="ja">
  <head>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <link rel="shortcut icon" href="./client/favicon.ico"/>
    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.2.1/css/bootstrap.min.css" integrity="sha384-GJzZqFGwb1QTTN6wy59ffF1BuGJpLSa9DkKMp0DgiMDm4iYMj70gZWKYbI706tWS" crossorigin="anonymous">
    <title>NPB Live-cloud!</title>
    <style type="text/css">
      div.TPS { /* 小画面用 */
        padding-left: 5px;
        border-left-width: 5px;
        border-left-style: solid;
      }
      @media only screen and (min-width:651px) { /* 中画面用 */
        div.TPS {
          padding-left: 15px;
          border-left-width: 8px;
        }
      }
      div.TPS.baystars  {border-color: dodgerblue;}
      div.TPS.giants    {border-color: orange;}
      div.TPS.tigers    {border-color: yellow;}
      div.TPS.swallows  {border-color: limegreen;}
      div.TPS.dragons   {border-color: darkblue;}
      div.TPS.carp      {border-color: red;}
      div.TPS.hawks     {border-color: gold;}
      div.TPS.lions     {border-color: aqua;}
      div.TPS.buffaloes {border-color: darkgoldenrod;}
      div.TPS.eagles    {border-color: firebrick;}
      div.TPS.fighters  {border-color: steelblue;}
      div.TPS.marines   {border-color: black;}
    </style>
  </head>
  <body>
    <div class="container-fluid">
      <div class="row bg-dark text-white">
        <div class="col-2 giants TPS">-.--</div>
        <div class="col-2 baystars TPS">-.--</div>
        <div class="col-2 tigers TPS">-.--</div>
        <div class="col-2 carp TPS">-.--</div>
        <div class="col-2 dragons TPS">-.--</div>
        <div class="col-2 swallows TPS">-.--</div>
      </div>
      <div class="row bg-dark text-white">
        <div class="col-2 lions TPS">-.--</div>
        <div class="col-2 hawks TPS">-.--</div>
        <div class="col-2 eagles TPS">-.--</div>
        <div class="col-2 marines TPS">-.--</div>
        <div class="col-2 fighters TPS">-.--</div>
        <div class="col-2 buffaloes TPS">-.--</div>
      </div>
    </div>
    <div class="container-fluid pt-3">
      <div class="raw no-gutters">
        <figure>
          <div class="col px-0">
            <div class="chartcontainer" id="chart">
              <!-- svg -->
            </div>
          </div>
        </figure>
      </div>
    </div>
    <!-- footer -->
    <div class="container-fluid">
      <div class="raw text-center small text-muted my-2">
        <a href="" class="text-muted" data-toggle="modal" data-target="#howtouse">つかいかた</a>
      </div>
      <div class="raw text-center small text-muted my-2">
        NPB-LiveCloud! 
        <a href="https://github.com/suibari" class="text-muted">@suibari</a>
      </div>
    </div>
    <!-- modal -->
    <div class="modal fade" id="howtouse" tabindex="-1" role="dialog" aria-hidden="true">
      <div class="modal-dialog" role="document">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title" id="exampleModalLabel">つかいかた</h5>
            <button type="button" class="close" data-dismiss="modal" aria-label="Close">
              <span aria-hidden="true">&times;</span>
            </button>
          </div>
          <div class="modal-body">
            <div class="container-fluid">
              <div class="raw　no-gutters">
                <ul>
                  <li>文字の大きさは、そのワードのツイート総数です。</li>
                  <li>文字の色は、球団カラーに対応しています。</li>
                  <li>画面上部の数値は、各球団の盛り上がり度(現在)です。</li>
                  <li>表示は10秒毎に自動更新されます。</li>
                  <li>毎日AM1:00～7:00はメンテナンス時間です。</li>
                </ul>
              </div>
            </div>
          </div>
          <div class="modal-footer">
            <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
          </div>
        </div>
      </div>
    </div>

    <!-- Optional JavaScript -->
    <script src="./client/wordCloud.js"></script>
    <script src="https://d3js.org/d3.v5.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/d3-cloud/1.2.5/d3.layout.cloud.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/socket.io/2.3.0/socket.io.js"></script>
    <!-- jQuery first, then Popper.js, then Bootstrap JS -->
    <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.6/umd/popper.min.js" integrity="sha384-wHAiFfRlMFy6i5SRaxvfOCifBUQy1xHdJ/yoi7FRNXMRBu5WHdZYu1hA6ZOblgut" crossorigin="anonymous"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.2.1/js/bootstrap.min.js" integrity="sha384-B0UglyR+jN6CkvvICOB2joaf5I4l3gm9GU6Hc1og6Ls7i6U/mkkaduKaBhlAXv9k" crossorigin="anonymous"></script>
    <script>
      // #chartにワードクラウドインスタンス生成
      var myWordCloud = new wordCloud('#chart');

      io.connect().on('update', (data) => {
        console.log('YUKI.N > received data, counts:' + data.count.length);
        // ワードクラウド更新
        myWordCloud.update(data.count);
        // TPS更新
        for (let team in data.tps) {
          $('.TPS.'+ team).text(data.tps[team]);
        }
      })
    </script>
  </body>
</html>